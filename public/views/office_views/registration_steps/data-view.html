<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/polymerfire/firebase-document.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-input/paper-textarea.html">
<link rel="import" href="/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="/bower_components/gold-email-input/gold-email-input.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">

<link rel="import" href="/styles/input-styles.html">
<link rel="import" href="/styles/layout-styles.html">
<link rel="import" href="/styles/header-styles.html">
<link rel="import" href="/styles/button-styles.html">

<dom-module id="data-view">
    <template>
        <style include="button-styles layout-styles input-styles header-styles">
            :host {
                --iron-collapse-transition-duration: 600ms;
            }
        </style>
        <div class="main-frame">
            <header class="subsection">
                <h1>Registrace ordinace</h1>
                <span>Tyto údaje můžete později změnit v nastavení</span>
            </header>

            <paper-button id="step1_button" type="button" on-tap="toggleChange" disabled="[[collapse]]">
                [[_computeButtonText(collapse, 1)]]
            </paper-button>
            <hr>

            <iron-collapse opened="[[collapse]]">
                <div class="subsection grid">

                    <section>
                        <h2>Adresa</h2>
                        <paper-input id="cinput" label="Město" minlength="1" maxlength="20">
                        </paper-input>
                        <paper-input id="sinput" label="Ulice a číslo popisné" minlength="1"
                                     maxlength="80"></paper-input>
                        <h2>Vaše specializace</h2>
                        <paper-dropdown-menu label="Specializace">
                            <paper-listbox class="dropdown-content">
                                <template is="dom-repeat" items="[[specializations]]" as="entry">
                                    <paper-item>[[entry]]</paper-item>
                                </template>
                            </paper-listbox>
                        </paper-dropdown-menu>
                        <h2>Délka návštěvy</h2>
                        <p>Zde zadejte odhad délky návštěvy pacienta v minutách. Podle této hodnoty a ordinačních hodin
                            určíme objednávací časy.</p>
                        <paper-input type="number" label="Délka návštěvy" min="1" max="360" value="20">
                            <div suffix>min</div>
                        </paper-input>
                    </section>
                    <section>
                        <h2>Ordinační hodiny</h2>
                        <template is="dom-repeat" items="[[days]]" as="entry">
                            <div class="row">
                                <paper-checkbox checked="{{entry.checked}}">[[entry.name]]</paper-checkbox>
                            </div>
                        </template>
                    </section>
                </div>
            </iron-collapse>
            <paper-button id="step2_button" on-tap="toggleChange" disabled="[[!collapse]]">
                [[_computeButtonText(collapse, 2)]]
            </paper-button>
            <hr>
            <iron-collapse opened="[[!collapse]]">
                <template is="dom-if" if="[[renderStep2]]">
                    <div class="subsection grid">
                        <section>
                            <h2>Zařízení v čekárně</h2>
                            <p>Zaškrtněte, pokud si přejete přidat zařízení v čekárně, které slouží k zařazení pacientů,
                                kteří se neobjednali online případně po telefonu.
                            </p>
                            <paper-checkbox checked="{{device_checked}}">Přidat zařízení</paper-checkbox>
                            <p hidden="[[!device_checked]]">V krabičce u zařízení jsme Vám poslali papírek
                                na kterém je napsán identifikátor. Tuto sekvenci znaků prosím opište do políčka
                                níže:</p>
                            <paper-input id="id_input_id" label="Identifikátor"
                                         hidden="[[!device_checked]]"></paper-input>
                            <h2>Vřejné informace profilu</h2>
                            <p>Zaškrtněte prosím, které informace si přejete zobrazit u Vašeho profilu.</p>
                            <p>Pokud chcete, aby se pacienti mohli objednat přes telefon, prosím zaškrtněte tuto
                                možnost:</p>
                            <paper-checkbox checked="{{phone_number_checked}}">Telefonní číslo</paper-checkbox>
                            <paper-input id="phone_id" label="Telefonní číslo" hidden="[[!phone_number_checked]]">
                            </paper-input>
                            <paper-checkbox checked="{{email_checked}}">Email</paper-checkbox>
                            <gold-email-input id="email_id" label="Email"
                                              hidden="[[!email_checked]]"></gold-email-input>
                        </section>
                        <section>
                            <h2>Text pro pacienty</h2>
                            <p>Tento text se zobrazí na stránce Vaší ordinace. Můžete zde zadat libovolnou zprávu
                                pacientům.
                                Zpráva není povinná.</p>
                            <paper-textarea label="Zpráva pro pacienty" char-counter maxlength="400"></paper-textarea>
                            <paper-button responsive on-tap="finish">
                                Dokončit
                            </paper-button>
                            <!--<a href="/office/registration/confirm">Dokončit</a>-->
                        </section>
                    </div>
                </template>
            </iron-collapse>
        </div>
    </template>

    <script>
        Polymer({
            is: 'data-view',

            properties: {
                collapse: {
                    type: Boolean,
                    value: true
                },
                days: {
                    type: Array,
                    value: [
                        {'name': 'Pondělí', 'checked': true},
                        {'name': 'Úterý', 'checked': true},
                        {'name': 'Středa', 'checked': true},
                        {'name': 'Čtvrtek', 'checked': true},
                        {'name': 'Pátek', 'checked': true},
                        {'name': 'Sobota', 'checked': false},
                        {'name': 'Neděle', 'checked': false}
                    ]
                },

                specializations: {
                    type: Array,
//                    TODO: načíst z DB
                    value: ['Zubař', 'Rektálník', 'Gynekolog']
                },

                device_checked: {
                    type: Boolean,
                    observer: '_onDevChecked'
                },

                phone_number_checked: {
                    type: Boolean,
                    observer: '_onPhoneChecked'
                },

                renderStep2: {
                    type: Boolean,
                    value: false
                }
            },

            finish: function () {
                console.log("finish");
            },

            _computeButtonText: function (collapse, index) {
                if (collapse) {
                    return (index == 1) ? "Krok1" : "Další krok";
                } else {
                    return (index == 1) ? "Upravit krok 1" : "Krok2";
                }
            },

            toggleChange: function () {
                this.renderStep2 = true;
                this.collapse = !this.collapse;
            }
        });
    </script>
</dom-module>
